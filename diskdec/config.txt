uci set network.lookback=interface
uci set network.lookback.ifname='lo'
uci set network.lookback.proto='static'
uci set network.lookback.ipaddr='127.0.0.1'
uci set network.lookback.netmask='255.0.0.0'

uci set network.lan=interface
uci set network.lan.type='bridge'
uci set network.lan.ifname='eth0'
uci set network.lan.proto='static'
uci set network.lan.netmask='255.255.255.0'
uci set network.lan.ip6assign='60'
uci set network.lan.ipaddr='192.168.1.1'

uci set network.wan=interface
uci set network.wan.ifname='eth1'
uci set network.wan.proto='dhcp'
uci set network.wan.dns='127.0.0.1'

uci set network.usb=interface
uci set network.usb.ifname='eth2'
uci set network.usb.proto='dhcp'
uci set network.wan.dns='127.0.0.1'

uci set network.openvpn=interface
uci set network.openvpn.proto='none'
uci set network.openvpn.ifname='tun0'

uci commit network
/etc/init.d/network restart

EXIST=$(uci show firewall | grep "name='nofw'")

if [ -n "$EXIST" ]; then
  echo "Zone 'nofw' already exists, skip adding."
  uci set firewall.@forwarding[0]=forwarding
  uci set firewall.@forwarding[0].src='lan'
  uci set firewall.@forwarding[0].dest='nofw'
  exit 0
fi

uci add firewall zone
uci set firewall.@zone[-1]=zone
uci set firewall.@zone[-1].name='nofw'
uci set firewall.@zone[-1].network='openvpn'
uci set firewall.@zone[-1].input='ACCEPT'
uci set firewall.@zone[-1].forward='DROP'
uci set firewall.@zone[-1].masq='1'
uci set firewall.@zone[-1].output='ACCEPT'

uci set firewall.@zone[1].network='wan' 'wan6' 'usb'

uci set firewall.@forwarding[0]=forwarding
uci set firewall.@forwarding[0].src='lan'
uci set firewall.@forwarding[0].dest='nofw'

uci add firewall forwarding
uci set firewall.@forwarding[-1]=forwarding
uci set firewall.@forwarding[-1].src='docker'
uci set firewall.@forwarding[-1].dest='wan'

uci commit firewall
/etc/init.d/firewall restart